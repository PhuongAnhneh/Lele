<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>admin</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
        integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="./admin.css">
</head>

<body>
    <div class="admin-container">
        <h2>Danh sách sản phẩm</h2>
        <div class="btn-add">
            <button id="btn-add">Add</button>
        </div>
        <div id="list">
            <div></div>
        </div>
        <div id="form-product">
            <button id="delete">x</button>
            <form action="" id="form">
                <div class="form-infor">
                    <label for="category">Loại sản phẩm</label>
                    <input type="text" id="category" name="category">
                </div>
                <div class="form-infor">
                    <label for="productName">Tên sản phẩm</label>
                    <input type="text" id="productName" name="productName">
                </div>
                <div class="form-infor">
                    <label for="price">Giá sản phẩm</label>
                    <input type="number" id="price" name="price">
                </div>
                <div class="form-infor">
                    <label for="image-1">Ảnh 1</label>
                    <input type="text" id="image-1" name="image-1">
                </div>
                <div class="form-infor">
                    <label for="image-2">Ảnh 2</label>
                    <input type="text" id="image-2" name="image-2">
                </div>

                <div class="btn-addNew"><button type="submit">Tạo mới</button></div>
            </form>
        </div>
    </div>
    <script>

        // Modal admin
        const addButton = document.getElementById("btn-add")
        const formProduct = document.getElementById("form-product")
        const category = document.getElementById("category");
        const name = document.getElementById("productName");
        const price = document.getElementById("price");
        const image_1 = document.getElementById("image-1");
        const image_2 = document.getElementById("image-2");
        addButton.addEventListener("click", function () {
            formProduct.style.transform = "translate(0, 0)"
        });
        const deleteButton = document.getElementById("delete")
        deleteButton.addEventListener("click", function () {
            formProduct.style.transform = "translate(-100%, 0)"
        });
        const form = document.getElementById("form")
        form.addEventListener("submit", function (e) {
            e.preventDefault() // ngan reload
            // const formData = new FormData(event.target);
            // const data = {};
            // formData.forEach((value, key) => {
            //     data[key] = value;
            // });
           

            const editProduct = {
                category,
                name,
                price,
                image: [
                    image_1,
                    image_2
                ]
            }

            fetch("http://localhost:8000/api/product/create", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(editProduct)
            })
                .then(response => response.json())
                .then(responseData => {
                    console.log(responseData);
                })
                .catch(error => {
                    console.error("Lỗi: " + error);
                });


        })

        fetch('http://localhost:8000/api/product/getAll').then(response => response.json()) // .then khi thanh cong, trich suat json tu response
        .then(data => {
                const list = document.getElementById("list")
                data.allProduct.forEach((item, index) => { // duyet qua tung phan tu cua mang
                    const listItem = document.createElement("div")
                    listItem.setAttribute("productId", item._id)
                    listItem.innerHTML = `
                    <div id="table"> 
                        <div>${item.category}</div>  
                        <div>${item.name}</div> 
                        <div>${item.price}</div> 
                        <div class="img-product">
                            <img src=${item.image[0]} alt="">
                        </div>   
                        <div class="edit"><i class="fa-regular fa-pen-to-square"></i></div>
                        <div class="delete"><i class="fa-solid fa-trash"></i></div>
                    </div>       
                `
                    list.appendChild(listItem) // moi 1 lan lap "list" se nhan 1 children la "listItem"
                    const editBtn = document.querySelectorAll(".edit")
                    editBtn.forEach(function(button, index) {
                        button.addEventListener("click", function() {
                            formProduct.style.transform = "translate(0, 0)"
                            console.log(item);
                            // category.value = item.category
                            // name.value = item.name
                            // price.value = item.price
                            // image_1.value = item.image[0]
                            // image_2.value = item.image[1]
                        })
                    }) 
                        })
                    })
            .catch(err => {
                console.log(err);
            })
    </script>
</body>










</html>